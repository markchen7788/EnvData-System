<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<title>商品</title>
	<link rel="stylesheet" href="./layui/css/layui.css">
</head>

<body>
	<script src="./layui/layui.js"></script>
	<script src="func.js"></script>
	<form class="layui-form" action="">
		<div class="layui-row">
			<div class="layui-col-md1">
				<input type="text" name="condition" placeholder="查询" autocomplete="off" class="layui-input">
			</div>
			<div class="layui-col-md3 ">
				<button class="layui-btn " lay-submit lay-filter="formDemo">查询</button>
			</div>
		</div>


	</form>
	<br>
	<div id="card">
		<div class="layui-card">
			<div class="layui-card-header layui-bg-orange">西安水质监测表
				<div class="layui-layout-right">
					<a href="table.html"><i class="layui-icon layui-icon-search"
							style="font-size: 15px; color: #FFFFFF;">查看</i></a></h2>
					&nbsp;&nbsp;<a href="create_table.html"><i class="layui-icon layui-icon-edit"
							style="font-size: 15px; color: #FFFFFF;">修改</i></a>&nbsp;&nbsp;&nbsp;</h2>
				</div>
			</div>
			<div class="layui-card-body">
				<span class="layui-badge">CO2</span>
				<span class="layui-badge">NH4+</span>
				<span class="layui-badge">Fe2+</span>
			</div>
		</div>
	</div>
	<script id="demo" type="text/html">
		{{# 
			for(var i in d){ 
		}}
		
		<div class="layui-card">
			<div class="layui-card-header layui-bg-orange">	<b>{{d[i][0]}}</b>
				<div class="layui-layout-right">
					<b><i class="layui-icon layui-icon-time">{{d[i][1]}}</i></b>
				</div>
			</div>
			<div class="layui-card-body">
				
				<span class="layui-badge layui-bg-green">{{d[i][2]}}</span>
				<hr class="layui-border-orange">
				{{# for(var j=3;j<d[i].length;j++){ }}
				<span class="layui-badge">{{d[i][j]}}</span>
			{{#
			 }
			}}
			<hr class="layui-border-orange">
			<b>
			<a href="table.html?tableName={{i}}"><i class="layui-icon layui-icon-search"
				style="font-size: 15px; color: #FF5722;">查看</i></a></h2>
		&nbsp;&nbsp;<a href="create_table.html?Id={{i}}"><i class="layui-icon layui-icon-edit"
				style="font-size: 15px; color: #FF5722;">修改</i></a>&nbsp;&nbsp;&nbsp;</h2>
		</b>
			</div>
		</div>
	</div>

	{{# } }}
	</script>
	<script>
		//注意：折叠面板 依赖 element 模块，否则无法进行功能性操作
		layui.use(['element', 'jquery', 'laytpl', 'form'], function () {
			var element = layui.element;
			const $ = layui.jquery;
			var laytpl = layui.laytpl;
			var form = layui.form;

			form.on('submit(formDemo)', function (data) {
				updateCurrentPage(data.field.condition)
				return false;
			});
			updateCurrentPage("");
			function updateCurrentPage(con) {
				var condition = { "condition": con };
				$.ajax({
					url: 'http://'+hostName+'/test/getTableInfo',
					type: 'post',
					data: condition,
					success: function (res) {
						console.log(res)
						var item = {}
						for (var i in res) {
							if (item.hasOwnProperty(res[i].表名)) {
								item[res[i].表名].push(res[i].参数名);
							}
							else {
								item[res[i].表名] = []
								item[res[i].表名].push(getParameter(res[i].注释, 'tableName'))
								item[res[i].表名].push(dateFormat("YYYY-mm-dd HH:MM:SS",new Date(res[i].创建时间)))
								item[res[i].表名].push(getParameter(res[i].注释, 'comment'))
							}
						}
						console.log(item)
						var getTpl = demo.innerHTML;
						laytpl(getTpl).render(item, function (html) {
							$("#card").html(html);
						});
						//$('p').text(JSON.stringify(res))
					}
					//…
				});
			}
		});
	</script>
</body>

</html>